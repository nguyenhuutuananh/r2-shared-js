{"version":3,"file":"metadata.js","sourceRoot":"","sources":["../../../../src/models/metadata.ts"],"names":[],"mappings":"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","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport { JsonStringConverter } from \"@r2-utils-js/_utils/ta-json-string-converter\";\n// https://github.com/edcarroll/ta-json\nimport {\n    JsonConverter,\n    JsonElementType,\n    JsonObject,\n    JsonProperty,\n    OnDeserialized,\n} from \"ta-json-x\";\n\nimport { BelongsTo } from \"./metadata-belongsto\";\nimport { Contributor } from \"./metadata-contributor\";\nimport { JsonContributorConverter } from \"./metadata-contributor-json-converter\";\nimport { MediaOverlay } from \"./metadata-media-overlay\";\nimport { IStringMap } from \"./metadata-multilang\";\nimport { Properties } from \"./metadata-properties\";\nimport { Subject } from \"./metadata-subject\";\nimport { JsonSubjectConverter } from \"./metadata-subject-json-converter\";\n\n// export interface IMeta {\n//     property: string;\n//     value: string;\n//     children: IMeta[];\n// }\n\n// tslint:disable-next-line:max-line-length\n// https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n@JsonObject()\nexport class Metadata {\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L11\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L11\n    @JsonProperty(\"@type\")\n    public RDFType!: string;\n\n    // TODO: array? https://github.com/opds-community/drafts/issues/24\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L15\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L15\n    @JsonProperty(\"title\")\n    // @JsonType(String)\n    // not needed because primitive string union with\n    // simple object type (string keys, string values)\n    public Title!: string | IStringMap; // | string[] | IStringMap[]\n\n    // TODO: array? https://github.com/opds-community/drafts/issues/24\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L33\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L22\n    @JsonProperty(\"subtitle\")\n    public SubTitle!: string | IStringMap;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L7\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L7\n    @JsonProperty(\"identifier\")\n    public Identifier!: string;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L81\n    @JsonProperty(\"author\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Author!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L84\n    @JsonProperty(\"translator\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Translator!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L87\n    @JsonProperty(\"editor\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Editor!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L90\n    @JsonProperty(\"artist\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Artist!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L93\n    @JsonProperty(\"illustrator\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Illustrator!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L96\n    @JsonProperty(\"letterer\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Letterer!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L99\n    @JsonProperty(\"penciler\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Penciler!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L102\n    @JsonProperty(\"colorist\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Colorist!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L105\n    @JsonProperty(\"inker\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Inker!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L108\n    @JsonProperty(\"narrator\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Narrator!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L111\n    @JsonProperty(\"contributor\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Contributor!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L114\n    @JsonProperty(\"publisher\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Publisher!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L117\n    @JsonProperty(\"imprint\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Imprint!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L66\n    @JsonProperty(\"language\")\n    @JsonElementType(String)\n    @JsonConverter(JsonStringConverter)\n    public Language!: string[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L51\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L29\n    @JsonProperty(\"modified\")\n    public Modified!: Date;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L55\n    @JsonProperty(\"published\")\n    public PublicationDate!: Date;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L78\n    @JsonProperty(\"sortAs\")\n    public SortAs2!: string;\n    @JsonProperty(\"sort_as\")\n    public SortAs1: string | undefined;\n    get SortAs(): string | undefined {\n        return this.SortAs2 ? this.SortAs2 : this.SortAs1;\n    }\n    set SortAs(sortas: string | undefined) {\n        if (sortas) {\n            this.SortAs1 = undefined;\n            this.SortAs2 = sortas;\n        }\n    }\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L129\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L33\n    @JsonProperty(\"description\")\n    public Description!: string;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L120\n    @JsonProperty(\"readingProgression\")\n    public Direction2!: string; // TODO: enum \"rtl\", \"ltr\", \"auto\"\n    @JsonProperty(\"direction\")\n    public Direction1: string | undefined;\n    get Direction(): string | undefined {\n        return this.Direction2 ? this.Direction2 : this.Direction1;\n    }\n    set Direction(direction: string | undefined) {\n        if (direction) {\n            this.Direction1 = undefined;\n            this.Direction2 = direction;\n        }\n    }\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L140\n    @JsonProperty(\"belongsTo\")\n    public BelongsTo2!: BelongsTo;\n    @JsonProperty(\"belongs_to\")\n    public BelongsTo1: BelongsTo | undefined;\n    get BelongsTo(): BelongsTo | undefined {\n        return this.BelongsTo2 ? this.BelongsTo2 : this.BelongsTo1;\n    }\n    set BelongsTo(belongsto: BelongsTo | undefined) {\n        if (belongsto) {\n            this.BelongsTo1 = undefined;\n            this.BelongsTo2 = belongsto;\n        }\n    }\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L132\n    @JsonProperty(\"duration\")\n    public Duration!: number;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L136\n    @JsonProperty(\"numberOfPages\")\n    public NumberOfPages!: number;\n\n    // public OtherMetadata: IMeta[];\n\n    // TODO: not in JSON Schema\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/tree/master/schema\n    @JsonProperty(\"media-overlay\")\n    public MediaOverlay!: MediaOverlay;\n\n    // TODO: not in JSON Schema??\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    @JsonProperty(\"rights\")\n    public Rights!: string;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/917c83e798e3eda42b3e9d0dc92f0fef31b16211/schema/extensions/epub/metadata.schema.json#L7\n    @JsonProperty(\"rendition\")\n    public Rendition!: Properties;\n\n    // TODO: not in JSON Schema?? https://github.com/readium/webpub-manifest/issues/14\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    @JsonProperty(\"source\")\n    public Source!: string;\n\n    // TODO: not in JSON Schema?? https://github.com/readium/webpub-manifest/issues/13\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    @JsonProperty(\"subject\")\n    @JsonConverter(JsonSubjectConverter)\n    @JsonElementType(Subject)\n    public Subject!: Subject[];\n\n    // TODO: not in JSON Schema??\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    // @JsonProperty(\"epub-type\")\n    // @JsonElementType(String)\n    // public EpubType!: string[];\n\n    @OnDeserialized()\n    // tslint:disable-next-line:no-unused-variable\n    // @ts-ignore: TS6133 (is declared but its value is never read.)\n    protected _OnDeserialized() {\n        // tslint:disable-next-line:max-line-length\n        // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L153\n        // tslint:disable-next-line:max-line-length\n        // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L50\n        if (!this.Title) {\n            console.log(\"Metadata.Title is not set!\");\n        }\n        // if (!this.Identifier) {\n        //     console.log(\"Metadata.Identifier is not set!\");\n        // }\n    }\n}\n"]}