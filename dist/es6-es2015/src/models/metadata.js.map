{"version":3,"file":"metadata.js","sourceRoot":"","sources":["../../../../src/models/metadata.ts"],"names":[],"mappings":"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","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport { JsonStringConverter } from \"@r2-utils-js/_utils/ta-json-string-converter\";\n// https://github.com/edcarroll/ta-json\nimport {\n    JsonConverter,\n    JsonElementType,\n    JsonObject,\n    JsonProperty,\n    OnDeserialized,\n} from \"ta-json-x\";\n\nimport { BelongsTo } from \"./metadata-belongsto\";\nimport { Contributor } from \"./metadata-contributor\";\nimport { JsonContributorConverter } from \"./metadata-contributor-json-converter\";\nimport { MediaOverlay } from \"./metadata-media-overlay\";\nimport { IStringMap } from \"./metadata-multilang\";\nimport { Properties } from \"./metadata-properties\";\nimport { Subject } from \"./metadata-subject\";\nimport { JsonSubjectConverter } from \"./metadata-subject-json-converter\";\n\n// export interface IMeta {\n//     property: string;\n//     value: string;\n//     children: IMeta[];\n// }\n\n// tslint:disable-next-line:max-line-length\n// https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n@JsonObject()\nexport class Metadata {\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L11\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L11\n    @JsonProperty(\"@type\")\n    public RDFType!: string;\n\n    // TODO: array? https://github.com/opds-community/drafts/issues/24\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L15\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L15\n    @JsonProperty(\"title\")\n    // @JsonType(String)\n    // not needed because primitive string union with\n    // simple object type (string keys, string values)\n    public Title!: string | IStringMap; // | string[] | IStringMap[]\n\n    // TODO: array? https://github.com/opds-community/drafts/issues/24\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L33\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L22\n    @JsonProperty(\"subtitle\")\n    public SubTitle!: string | IStringMap;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L7\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L7\n    @JsonProperty(\"identifier\")\n    public Identifier!: string;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L81\n    @JsonProperty(\"author\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Author!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L84\n    @JsonProperty(\"translator\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Translator!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L87\n    @JsonProperty(\"editor\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Editor!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L90\n    @JsonProperty(\"artist\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Artist!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L93\n    @JsonProperty(\"illustrator\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Illustrator!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L96\n    @JsonProperty(\"letterer\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Letterer!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L99\n    @JsonProperty(\"penciler\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Penciler!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L102\n    @JsonProperty(\"colorist\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Colorist!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L105\n    @JsonProperty(\"inker\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Inker!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L108\n    @JsonProperty(\"narrator\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Narrator!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L111\n    @JsonProperty(\"contributor\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Contributor!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L114\n    @JsonProperty(\"publisher\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Publisher!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L117\n    @JsonProperty(\"imprint\")\n    @JsonElementType(Contributor)\n    @JsonConverter(JsonContributorConverter)\n    public Imprint!: Contributor[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L66\n    @JsonProperty(\"language\")\n    @JsonElementType(String)\n    @JsonConverter(JsonStringConverter)\n    public Language!: string[];\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L51\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L29\n    @JsonProperty(\"modified\")\n    public Modified!: Date;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L55\n    @JsonProperty(\"published\")\n    public PublicationDate!: Date;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L78\n    @JsonProperty(\"sortAs\")\n    public SortAs2!: string;\n    @JsonProperty(\"sort_as\")\n    public SortAs1: string | undefined;\n    get SortAs(): string | undefined {\n        return this.SortAs2 ? this.SortAs2 : this.SortAs1;\n    }\n    set SortAs(sortas: string | undefined) {\n        if (sortas) {\n            this.SortAs1 = undefined;\n            this.SortAs2 = sortas;\n        }\n    }\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L129\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L33\n    @JsonProperty(\"description\")\n    public Description!: string;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L120\n    @JsonProperty(\"readingProgression\")\n    public Direction2!: string; // TODO: enum \"rtl\", \"ltr\", \"auto\"\n    @JsonProperty(\"direction\")\n    public Direction1: string | undefined;\n    get Direction(): string | undefined {\n        return this.Direction2 ? this.Direction2 : this.Direction1;\n    }\n    set Direction(direction: string | undefined) {\n        if (direction) {\n            this.Direction1 = undefined;\n            this.Direction2 = direction;\n        }\n    }\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L140\n    @JsonProperty(\"belongsTo\")\n    public BelongsTo2!: BelongsTo;\n    @JsonProperty(\"belongs_to\")\n    public BelongsTo1: BelongsTo | undefined;\n    get BelongsTo(): BelongsTo | undefined {\n        return this.BelongsTo2 ? this.BelongsTo2 : this.BelongsTo1;\n    }\n    set BelongsTo(belongsto: BelongsTo | undefined) {\n        if (belongsto) {\n            this.BelongsTo1 = undefined;\n            this.BelongsTo2 = belongsto;\n        }\n    }\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L132\n    @JsonProperty(\"duration\")\n    public Duration!: number;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L136\n    @JsonProperty(\"numberOfPages\")\n    public NumberOfPages!: number;\n\n    // public OtherMetadata: IMeta[];\n\n    // TODO: not in JSON Schema\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/tree/master/schema\n    @JsonProperty(\"media-overlay\")\n    public MediaOverlay!: MediaOverlay;\n\n    // TODO: not in JSON Schema??\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    @JsonProperty(\"rights\")\n    public Rights!: string;\n\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/917c83e798e3eda42b3e9d0dc92f0fef31b16211/schema/extensions/epub/metadata.schema.json#L7\n    @JsonProperty(\"rendition\")\n    public Rendition!: Properties;\n\n    // TODO: not in JSON Schema?? https://github.com/readium/webpub-manifest/issues/14\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    @JsonProperty(\"source\")\n    public Source!: string;\n\n    // TODO: not in JSON Schema?? https://github.com/readium/webpub-manifest/issues/13\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    @JsonProperty(\"subject\")\n    @JsonConverter(JsonSubjectConverter)\n    @JsonElementType(Subject)\n    public Subject!: Subject[];\n\n    // TODO: not in JSON Schema??\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json\n    // @JsonProperty(\"epub-type\")\n    // @JsonElementType(String)\n    // public EpubType!: string[];\n\n    @OnDeserialized()\n    // tslint:disable-next-line:no-unused-variable\n    // @ts-ignore: TS6133 (is declared but its value is never read.)\n    protected _OnDeserialized() {\n        // tslint:disable-next-line:max-line-length\n        // https://github.com/readium/webpub-manifest/blob/0976680e25852b8a4c4802a052ba750ab3e89284/schema/metadata.schema.json#L153\n        // tslint:disable-next-line:max-line-length\n        // https://github.com/opds-community/drafts/blob/4d82fb9a64f35a174a5f205c23ba623ec010d5ec/schema/feed-metadata.schema.json#L50\n        if (!this.Title) {\n            console.log(\"Metadata.Title is not set!\");\n        }\n        // if (!this.Identifier) {\n        //     console.log(\"Metadata.Identifier is not set!\");\n        // }\n    }\n}\n"]}